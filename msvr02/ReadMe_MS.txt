SimpleMailServer

・概要
かなり機能を限定した非常にシンプルなメールサーバ（SMTP/POP3）です。
実際のメールサーバとして使うには機能不足ですが、メールクライアン
トなどを自作する場合のテスト用サーバとして使用するとか、メーラを
使ってP2Pメッセージ交換をしたいとか言う場合には便利かと思います。
また、ソースを同梱していますのでサンプルソースとして使ったりする
のにも良いでしょう。

・動作環境
Ｗｉｎｄｏｗｓ９５／９８／Ｍｅ／ＮＴ４／２Ｋ／ＸＰ以降とその構成
が動作するx86系ＰＣ。
ただし最新版の動作確認を行っているのはＮＴ４／Ｗｉｎ２Ｋだけです。
動作報告（特にＸＰ／Ｍｅ）などいただければ幸いです。

・必要ファイル
MSVCRT.dll	: Ｃランタイム。無い場合はVector等から入手して下さい。
MFC42.dll	: ＭＦＣランタイム。上記同様。

・使用法
任意のディレクトリに実行ファイルとiniファイルを解凍して下さい。
実行ファイルとiniファイルのみで利用可能です（iniファイルは無くて
も自動生成されますが一応あった方が良いです）ので、その他のファイ
ルは必要に応じて解凍して下さい。
実行はEXEをダブルクリックで起動するだけです。
起動するとタスクトレイ（タスクバーの時計などが表示される所）にポ
ストのアイコンが現れます。
このアイコンをクリックするとダイアログがでますので、各種設定やプ
ログラムの終了はこのダイアログを使ってください。
なお、ポート番号とかを変えていない限り、メーラの設定はこのプログ
ラムが動いているＰＣのホスト名やIPアドレスを送(SMTP)受(POP3)信サ
ーバに設定するだけです。
同一ＰＣ上で使うならサーバのホスト名／アドレスに「localhost」また
は「127.0.0.1」と入力してください。
以下はダイアログの説明です。

SMTPポート：
	SMTPの待ち受けポート番号です。
	デフォルトは標準の25番になっていますので良く解らない方は触ら
	ないでください。
POP3ポート：
	POP3の待ち受けポート番号です。
	デフォルトは標準の110番になっていますので良く解らない方は触ら
	ないでください。
ローカルからの接続のみ許可：
	チェックが入った状態（デフォルト）だとローカル以外（つまり別
	のコンピュータ）からの接続は受け付けません。
	テスト用などで使用する場合は攻撃されたりするのを防止するため
	にチェックを入れておいた方が良いでしょう。
	LANでP2Pメッセージ交換などする場合はチェックを外さないと他の
	ＰＣから接続できませんので、そう言う場合は外してください。
	ちなみにメールをリレーする能力はないのでSPAMの送信に利用され
	る心配はありませんが、spamerがちゃんとしたSMTPサーバだと思っ
	て利用してくる心配はありますので、インターネットに接続されて
	いる環境でチェックを外す場合は注意してくださいね。
設定値保存終了：
	上記の設定を変えた場合、このボタンを押すと設定値をiniファイル
	に書き込んで終了します。
	設定値が反映されるのは次回起動時からです。
設定値放棄終了：
	保存終了とは異なり設定値をiniファイルに書き込まずに終了します。
ダイアログ非表示：
	ダイアログを非表示にしてタスクトレイに入ります。（と言って
	もタスクトレイのアイコンはずっと表示されたままなんですけどね）
	再び表示したい場合はアイコンをクリックしてください。

それから、設定内容は実行ファイルと同じフォルダにMailSvr.ini（正確
には＜実行ファイル名から拡張子を取り除いた名称＞.iniなのでEXEのファ
イル名を変更すると変わります）に保存されます。
レジストリなどは一切弄りませんので、いらなくなったら全部消してく
ださい。
なお、ログファイルの記録機能も一応備わっています。
ただ、一般的なユーザの方々は使用しない可能性が高いので、これはini
ファイルを直接編集しないと使えません。
ログ記録したい場合はiniファイルの「logoutput=」の後を「1」に修正
して下さい。
そうするとiniファイル同様の構成で*.logファイルが書き出されます。

・制限
現バージョンはβなので機能は余り入念にチェックしていません。
おそらくバグはあるでしょう。
バグを発見した場合は可能な限り報告をしていただけるとありがたいで
す。（連絡先は下を参照）

なお、現時点での確認はOutlookExpress5.5でメッセージの送受信が出来
ることを確認しているのみです。
OEが使わないコマンドもありますので動作確認されていないコマンドも
存在します。
とくにメールチェッカーの類やメールをダウンロードせずに読むタイプ
の軽量メーラを使う場合は要注意かもしれません。

最後に、RFCの規定とは仕様が異なる部分がありますのでそれを以下に書
いておきます。

共通：
	SMTP/POP3共に「!shutdown」というコマンドを受信するとサーバを
	終了します。
	また、受信したメールはメモリ上に保存するだけですので、プログ
	ラムを終了すると、受信されたかどうかに関わらず全てのメッセー
	ジが消えてしまいます。
SMTP：
	コマンドはDATA/QUITとその他しか区別していません。
	つまり、本来のSMTPコマンドでは宛先などを指定してからでないと
	DATAを発行できませんがそう言った判断は一切しておらず、保存す
	るのはDATA以降に入力されたメッセージ本文のみです。
	もちろん無効なコマンドでもそのまま通ります。
	それから、Message-ID/Recievedヘッダの付与は行いません。
	空くまでMUA（メーラ等）から受け取ったメールを加工せずに保存す
	るだけです。
POP3：
	一応RFCで要求されている必須コマンドは実装されていて、オプショ
	ンコマンドについてはUSER/PASS/TOPが実装されています。
	ただし、ユーザ認証の概念は無いので、PASSさえ実行すれば内容如
	何を問わず誰でもアクセスが可能です。
	ただ、同時に認証されるのは１クライアントのみなので、複数のク
	ライアントからの要求でメッセージキューがおかしくなるようなこ
	とはありません。

・ソースについて
ソースはSRCMS.LZHに入っています。
VC++6.0用にコーディングされていますが、おそらくVC++4.2以降ならビ
ルド出来ると思います。
GUI関連のソースはVCが自動生成するスケルトンを利用しているので余り
綺麗ではありません。
それ以外は基本的に全てヘッダコメントや処理コメントを入れてあるの
でコメントを読めば中身は理解できると思います。
（ただし、STLとオブジェクト指向/デザインパターンの知識がある程度
必要です）
それから当初はSTLPort4.5.3でやっていたんですがどうもMFCと相性が
悪いのか不定期にメモリーリークするのでSTLはVC標準の物を使ってく
ださい。
なお、v0.1だとdebugビルドしたときにメモリリークの警告がでていまし
た。
一部実際に不具合があったところを直したのですが、その他STL関連のと
ころで意味不明なメモリリークがあったので試行錯誤して一応私のテス
ト環境では直っています。
ただ、このような状況ですので環境によっては直っていない可能性が充
分ありますが、その辺りはVC6のSTLサポートがいい加減なので勘弁して
ください。

・使用許諾
本ソフトはフリーウェアですが、著作権は放棄しません。
個人で使用する限りにおいてはソースの改変なども自由ですが、（改変
したものも含めて）再配布する際には作者の許可を取って下さい。
書籍等に掲載する場合も同様です。
営利目的で本ソフト及びその一部を利用する場合は、あらかじめ作者に
連絡を下さい。その内容を検討した上で判断を下します。
なお、本ソフトを使用すること／本ソフトのソースファイルを参考とす
ることにおいて発生したいかなる損害に対しても作者は一切の責任を負
いませんので、利用者個人の責任においてご利用下さい。

・連絡先
バグを発見した場合などは以下のアドレスにメール下さい。
時間と能力の許す限り対応いたしますが、保証は出来ません。
バグ修正／機能拡張版／動作報告の送付も大歓迎です。
mailto:b_51_@anet.ne.jp
http://isweb46.infoseek.co.jp/novel/b_51/
の掲示板を利用してくださっても構いません。

・バージョン番号について
私の作るソフトは基本的に以下のような規則に基づいてバージョン番号
を決定しています。
1.0未満		：ベータ版
1.0以上		：正式版（小数点以下はバグフィックスでアップし、整数
			  部は機能拡張でアップ）
'			：ドキュメントのみの変更などプログラム自体に修正がな
			  い場合は同じバージョン番号で「'」を付加

・履歴
0.2'	連絡先を変更
0.2		常駐形態の変更／メモリリークの修正／ボタン名称変更
		常駐したままWindowsを終了した場合に終了処理が動くよう修正
		サーバ終了処理を若干見直し
		同時起動防止処理を追加
0.1'	ドキュメントにメーラ設定に関する記述を追加
0.1		初版
